<!doctype html>
<html lang="pt" translate="no" class="notranslate">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="google" content="notranslate" />
  <title>Catálogo Técnico — PP-R Pipes (Mapa Interativo)</title>
  <style>
    :root{
      --bg:#ffffff;
      --text:#0f172a;
      --muted:#475569;
      --border:rgba(15,23,42,.12);
      --accent:#16a34a;
      --card:#ffffff;
      --shadow: 0 14px 40px rgba(0,0,0,.10);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; color:var(--text); background:var(--bg);}
    a{color:inherit; text-decoration:none}
    .container{width:min(1120px, calc(100% - 32px)); margin:0 auto;}

    .header{padding:22px 0 10px;}
    .kicker{color:var(--muted); font-weight:900; letter-spacing:.2px;}
    h1{margin:8px 0 0; font-size: clamp(22px, 3.2vw, 36px); line-height:1.06; font-weight:1000;}
    .lead{margin:10px 0 0; color:var(--muted); line-height:1.6;}

    .stack{display:grid; grid-template-columns: 1fr; gap:14px; align-items:start; padding:14px 0 22px;}
    .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); box-shadow: var(--shadow);}
    .pad{padding:16px;}

    /* Map */
    .mapWrap{position:relative; width:100%; max-width:860px; margin:0 auto;}
    .mapImg{width:100%; height:auto; display:block; user-select:none; -webkit-user-drag:none;}
    .hitLayer{position:absolute; inset:0; cursor:pointer;}

    /* Visual highlight drawn via SVG (only stroke), aligned to image coords */
    .overlaySvg{position:absolute; inset:0; width:100%; height:100%; pointer-events:none;}
    .overlaySvg path{fill:transparent; stroke: rgba(22,163,74,.85); stroke-width:3; opacity:0;}
    .overlaySvg path.show{opacity:1;}

    /* Callout */
    .callout{position:absolute; min-width: 240px; max-width: 320px; background:#fff; border:1px solid var(--border); border-radius:16px; box-shadow: 0 18px 48px rgba(0,0,0,.16); padding:12px 12px; display:none;}
    .callout.show{display:block;}
    .callout .t{font-weight:1000; margin:0 0 6px; font-size:14px;}
    .callout .p{margin:0; color:var(--muted); font-weight:850; line-height:1.45; font-size:12px;}
    .chips{display:flex; gap:6px; flex-wrap:wrap; margin-top:10px;}
    .chip{display:inline-flex; align-items:center; padding:6px 9px; border-radius:999px; border:1px solid var(--border); background:rgba(15,23,42,.03); color:var(--muted); font-weight:900; font-size:11px;}

    /* Selection */
    .pill{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:rgba(15,23,42,.03); color:var(--muted); font-weight:900; font-size:12px;}
    .btn{display:inline-flex; align-items:center; justify-content:center; gap:10px; padding:10px 12px; border-radius:14px; border:1px solid var(--border); background:rgba(15,23,42,.04); font-weight:950; cursor:pointer; min-height:44px;}
    .btn:hover{background:rgba(15,23,42,.06)}

    .tableWrap{overflow:auto; border-radius:16px; border:1px solid var(--border); margin-top:12px;}
    table{border-collapse:separate; border-spacing:0; width:100%; min-width:920px; background:#fff;}
    thead th{position:sticky; top:0; background:#f8fafc; z-index:1;}
    th, td{border-bottom:1px solid var(--border); border-right:1px solid var(--border); padding:10px 10px; text-align:center; font-weight:900; font-size:12px; white-space:nowrap;}
    th:first-child, td:first-child{text-align:left;}
    tr:last-child td{border-bottom:0;}
    th:last-child, td:last-child{border-right:0;}
    .rowTitle{font-weight:1000;}
    .legend{display:flex; gap:10px; flex-wrap:wrap; align-items:center; color:var(--muted); font-weight:850; font-size:12px; margin-top:10px;}
    .mark{display:inline-flex; align-items:center; justify-content:center; width:18px; height:18px; border-radius:999px; border:2px solid rgba(15,23,42,.65); font-size:12px; line-height:1;}
    .mark.std::before{content:"✓"; font-weight:1000;}
    .mark.dem{position:relative; border-width:3px;}
    .mark.dem::after{content:""; position:absolute; inset:3px; border:2px solid rgba(15,23,42,.65); border-radius:999px;}
    .muted{color:var(--muted); font-weight:850; line-height:1.55;}

    @media (max-width: 760px){
      .mapWrap{max-width:100%;}
      table{min-width:860px;}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="kicker">Catálogo Técnico • Mapa Interativo (Pixel‑Perfect)</div>
      <h1>Product Range Overview — PP‑R Pipes</h1>
      <p class="lead">Passe o mouse (ou toque) sobre cada segmento. O sistema usa leitura de pixel para evitar seleção fora do recorte e associa cada quadrante ao produto correto do catálogo.</p>
      <div style="margin-top:10px;"><span class="pill">Clique para fixar a seleção • Botão “Limpar” para desfazer</span></div>
    </div>

    <div class="stack">
      <section class="card">
        <div class="pad">
          <div class="mapWrap" id="mapWrap">
            <object id="mapObj" class="mapImg" data="./mapa_produto_interativo_stripes_like_screenshot_fixed2.svg" type="image/svg+xml" aria-label="Mapa circular do catálogo (SVG interativo)"></object>
            <div class="hitLayer" id="hitLayer" aria-label="Mapa interativo" role="application"></div>

            <svg class="overlaySvg" id="overlaySvg" preserveAspectRatio="none"></svg>

            <div class="callout" id="callout" aria-live="polite">
              <div class="t" id="callTitle">—</div>
              <div class="p" id="callText">—</div>
              <div class="chips" id="callChips"></div>
            </div>
          </div>

          <div class="muted" style="margin-top:10px;">
            Nota: a tabela de diâmetros abaixo é preenchida com base na faixa Ø indicada no próprio mapa (por padrão). Se você fornecer a matriz completa (✓/○) do catálogo, eu atualizo para 100% idêntico.
          </div>
        </div>
      </section>

      <section class="card">
        <div class="pad">
          <div class="kicker">Seleção</div>
          <div style="font-weight:1000; font-size:16px; margin-top:6px;" id="selName">Nenhum tubo selecionado</div>
          <p class="muted" style="margin:8px 0 0;" id="selDesc">Passe o mouse sobre um segmento para ver detalhes e a tabela de diâmetros.</p>

          <div class="tableWrap">
            <table aria-label="Tabela de diâmetros" id="diamTable"></table>
          </div>

          <div class="legend">
            <span><span class="mark std"></span> Produto standard (inferido pela faixa Ø)</span>
            <span><span class="mark dem"></span> Disponível sob encomenda (necessita tabela oficial)</span>
          </div>

          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
            <button class="btn" id="clearBtn" type="button">Limpar seleção</button>
          </div>
        </div>
      </section>
    </div>
  </div>


<script>
(function(){
  const DIAMS = [20,25,32,40,50,63,75,90,110,125,160,200,250,315,355,400];

  const PRODUCTS = [
    { id:"seg1", name:"ROMAKLIMA CT", desc:"PP‑RCT 125 + FG • SDR 17 • Ø125–Ø400 • 4 Stripes", range:[125,400] },
    { id:"seg2", name:"HELISYSTEM", desc:"PP‑R 100 • SDR 6 • Ø20–Ø110 • 1 Stripe", range:[20,110] },
    { id:"seg3", name:"HELISYSTEM", desc:"PP‑R 100 • SDR 7,4 • Ø20–Ø110 • 1 Stripe", range:[20,110] },
    { id:"seg4", name:"ROMAFASER", desc:"PP‑R 100 + FG • SDR 7,4 • Ø20–Ø110 • 4 Stripes", range:[20,110] },
    { id:"seg5", name:"ROMAKLIMA", desc:"PP‑R 100 + FG • SDR 11 • Ø32–Ø160 • 4 Stripes", range:[32,160] },
    { id:"seg6", name:"ROMAFASER", desc:"Anti‑UV • PP‑R 100 + FG • SDR 7,4 • Ø20–Ø75", range:[20,75] },
    { id:"seg7", name:"ROMAFASER CT +", desc:"PP‑RCT 125 + FG • SDR 9 • Ø32–Ø250 • 4 Stripes", range:[32,250] },
    { id:"seg8", name:"ROMAFASER CT", desc:"PP‑RCT 125 + FG • SDR 11 • Ø40–Ø250 • 4 Stripes", range:[40,250] },
  ];

  const mapObj   = document.getElementById("mapObj");
  const callout  = document.getElementById("callout");
  const callTitle= document.getElementById("callTitle");
  const callText = document.getElementById("callText");
  const callChips= document.getElementById("callChips");
  const selName  = document.getElementById("selName");
  const selDesc  = document.getElementById("selDesc");
  const diamTable= document.getElementById("diamTable");
  const clearBtn = document.getElementById("clearBtn");
  const mapWrap  = document.getElementById("mapWrap");

  let pinned = null;

  function buildDiamTable(p){
    const [minD,maxD] = p.range;
    let html = `<thead><tr><th>DIÂMETROS (mm)</th>${DIAMS.map(d=>`<th>${d}</th>`).join("")}</tr></thead>`;
    html += `<tbody><tr><th>${p.name}</th>`;
    for (const d of DIAMS){
      const ok = (d>=minD && d<=maxD);
      html += `<td>${ok ? "✓" : ""}</td>`;
    }
    html += `</tr></tbody>`;
    diamTable.innerHTML = html;
  }

  function clearSelection(){
    selName.textContent = "Nenhum tubo selecionado";
    selDesc.textContent = "Passe o mouse sobre um segmento para ver detalhes e a tabela de diâmetros.";
    diamTable.innerHTML = `<thead><tr><th>DIÂMETROS (mm)</th>${DIAMS.map(d=>`<th>${d}</th>`).join("")}</tr></thead><tbody><tr><th>—</th>${DIAMS.map(()=>`<td></td>`).join("")}</tr></tbody>`;
    if (callout) callout.style.display = "none";
    if (pinned && svgDoc) {
      const el = svgDoc.getElementById(pinned);
      if (el) el.classList.remove("active");
    }
    pinned = null;
  }

  function showCallout(clientX, clientY, p){
    callTitle.textContent = p.name;
    callText.textContent = p.desc;
    callChips.innerHTML  = (p.desc.split("•").map(s=>s.trim()).filter(Boolean).slice(0,5)).map(t=>`<span class="chip">${t}</span>`).join("");
    callout.style.display = "block";

    const rect = mapWrap.getBoundingClientRect();
    const pad = 10;
    const cw = callout.offsetWidth || 300;
    const ch = callout.offsetHeight || 130;
    let left = clientX + 14;
    let top  = clientY + 14;
    if (left + cw > rect.right - pad) left = clientX - cw - 14;
    if (top + ch > rect.bottom - pad) top = clientY - ch - 14;
    left = Math.max(rect.left + pad, Math.min(left, rect.right - cw - pad));
    top  = Math.max(rect.top  + pad, Math.min(top,  rect.bottom - ch - pad));
    callout.style.left = (left - rect.left) + "px";
    callout.style.top  = (top  - rect.top ) + "px";
  }

  function setSelection(p){
    selName.textContent = p.name;
    selDesc.textContent = p.desc;
    buildDiamTable(p);
  }

  let svgDoc = null;

  function bindSvg(){
    svgDoc = mapObj.contentDocument;
    if (!svgDoc) return;

    // Make only petals interactive (g.seg already has hover filter in SVG)
    PRODUCTS.forEach(p => {
      const el = svgDoc.getElementById(p.id);
      if (!el) return;

      el.addEventListener("mousemove", (e) => {
        if (pinned) return;
        setSelection(p);
        showCallout(e.clientX, e.clientY, p);
      });

      el.addEventListener("mouseleave", () => {
        if (pinned) return;
        if (callout) callout.style.display = "none";
      });

      el.addEventListener("click", (e) => {
        // toggle pin
        if (pinned === p.id){
          el.classList.remove("active");
          pinned = null;
          if (callout) callout.style.display = "none";
          clearSelection();
          return;
        }
        // unpin previous
        if (pinned){
          const prev = svgDoc.getElementById(pinned);
          if (prev) prev.classList.remove("active");
        }
        pinned = p.id;
        el.classList.add("active");
        setSelection(p);
        showCallout(e.clientX, e.clientY, p);
      });
    });
  }

  mapObj.addEventListener("load", bindSvg);
  clearBtn.addEventListener("click", clearSelection);
  clearSelection();
})();
</script>

</body>
</html>